// Code generated by github.com/lolopinto/ent/ent, DO NOT EDIT.

package action

import (
	"context"

	"github.com/lolopinto/ent/ent"
	"github.com/lolopinto/ent/ent/actions"
	"github.com/lolopinto/ent/ent/test_schema/models"
	"github.com/lolopinto/ent/ent/test_schema/models/configs"
	"github.com/lolopinto/ent/ent/viewer"
)

type CreateUserAction struct {
	builder *actions.EntMutationBuilder
	user    models.User
}

// CreateUserFromContext is the factory method to get an ...
func CreateUserFromContext(ctx context.Context) *CreateUserAction {
	v, err := viewer.ForContext(ctx)
	if err != nil {
		panic("tried to perform mutation without a viewer")
	}
	return CreateUser(v)
}

// CreateUser is the factory method to get an ...
func CreateUser(viewer viewer.ViewerContext) *CreateUserAction {
	return &CreateUserAction{
		builder: &actions.EntMutationBuilder{
			Viewer:    viewer,
			EntConfig: &configs.UserConfig{},
			Operation: ent.InsertOperation,
		},
	}
}

func (action *CreateUserAction) GetViewer() viewer.ViewerContext {
	return action.builder.GetViewer()
}

func (action *CreateUserAction) GetChangeset() (ent.Changeset, error) {
	return action.builder.GetChangeset(action.Entity())
}

func (action *CreateUserAction) Entity() ent.Entity {
	return &action.user
}

// SetEmailAddress sets the EmailAddress while editing the User ent
func (action *CreateUserAction) SetEmailAddress(emailAddress string) *CreateUserAction {
	action.builder.SetField("EmailAddress", emailAddress)
	return action
}

// SetFirstName sets the FirstName while editing the User ent
func (action *CreateUserAction) SetFirstName(firstName string) *CreateUserAction {
	action.builder.SetField("FirstName", firstName)
	return action
}

// SetLastName sets the LastName while editing the User ent
func (action *CreateUserAction) SetLastName(lastName string) *CreateUserAction {
	action.builder.SetField("LastName", lastName)
	return action
}

// getFieldMap returns the fields that could be edited in this mutation
func (action *CreateUserAction) getFieldMap() ent.ActionFieldMap {
	return ent.ActionFieldMap{
		"EmailAddress": &ent.MutatingFieldInfo{
			DB:       "email_address",
			Required: true,
		},
		"FirstName": &ent.MutatingFieldInfo{
			DB:       "first_name",
			Required: true,
		},
		"LastName": &ent.MutatingFieldInfo{
			DB:       "last_name",
			Required: true,
		},
	}
}

func (action *CreateUserAction) Validate() error {
	return action.builder.ValidateFieldMap(action.getFieldMap())
}

// Save is the method called to execute this action and save change
func (action *CreateUserAction) Save() (*models.User, error) {
	err := actions.Save(action)
	return &action.user, err
}

var _ actions.Action = &CreateUserAction{}
