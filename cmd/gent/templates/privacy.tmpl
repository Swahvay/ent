// Code generated by github.com/lolopinto/ent/ent, DO NOT edit. 

package models

import (
	"github.com/lolopinto/ent/ent"
	"github.com/lolopinto/ent/ent/privacy"
  "github.com/lolopinto/ent/ent/viewer"
)

// {{.Node}}PrivacyPolicy is the privacy policy for the {{.Node}} ent which helps decides if it's 
// visible to the viewer
type {{.Node}}PrivacyPolicy struct {
  {{.Node}} *{{.Node}}
}

// Rules is the list of rules that decides the visibility of the {{.Node}} ent to the viewer
func (policy {{.Node}}PrivacyPolicy) Rules() []ent.PrivacyPolicyRule {
	return []ent.PrivacyPolicyRule{
		privacy.AllowIfOmniscientRule{},
    // BEGIN MANUAL SECTION: Add custom privacy rules below
    // END MANUAL SECTION of privacy rules
		privacy.AlwaysDenyRule{},
	}
}

// AllowIfViewerCanSee{{.Node}}Rule is a reusable rule that can be called by different ents to see if the contact can be visible
type AllowIfViewerCanSee{{.Node}}Rule struct {
	{{.Node}}ID string
}

// GenEval evaluates that the ent is visible to the user 
func (rule AllowIfViewerCanSee{{.Node}}Rule) GenEval(viewer viewer.ViewerContext, entity interface{}, privacyResultChan chan<- ent.PrivacyResult) {
	entResultChan := make(chan {{.NodeResult}})
	go GenLoad{{.Node}}(viewer, rule.{{.Node}}ID, entResultChan)
	entResult := <-entResultChan

	if entResult.Error != nil {
		privacyResultChan <- ent.SkipPrivacyResult
	} else {
		privacyResultChan <- ent.AllowPrivacyResult
	}
}
